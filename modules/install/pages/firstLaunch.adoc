= Настройка сервера {dv}

Пользователь, выполняющий настройку {dv}, должен являться локальным администратором и быть членом группы безопасности _{dv} Administrators_. Если группа безопасности _{dv} Administrators_ не существует, она будет создана автоматически при первой настройке системы {dv}.

Если для подключения к СУБД планируется использовать Windows-аутентификацию, у учетной записи, от имени которой запущен мастер настройки {dv} (_{cns}_), должны быть следующие права:

include::partial$dbRights.adoc[]

.Выполните следующие шаги, чтобы подготовить систему {dv} к работе:
. Откройте программу _{cns}_ (ярлык {dv} 5 Server Console) и согласитесь с продолжением настройки.
. На странице _Лицензия_ активируйте ключ лицензии {dv}.
+
.Мастер настройки {dv}
image::configMasterLicense.png[Мастер настройки {dv}]
+
.. Нажмите *Активировать ключ*.
.. В открывшемся окне выберите режим _Онлайн активация_ и нажмите *Далее*.
.. Укажите серийный номер лицензии и нажмите *Завершить*.
+
[TIP]
====
Подробнее про активацию можно прочитать xref:dev@platfrom:admin:activation.adoc[здесь].

В случае отсутствия подключения к сети Интернет воспользуйтесь xref:dev@platfrom:admin:activation.adoc#offlineActivation[офлайн-активацией].
====
+
. На странице _Требования к системе_ ознакомьтесь с результатами проверки требований {dv} к системе.
+
.Проверка основных требований к системе
image::configMasterRequirements.png[Проверка основных требований к системе]
+
* Если не пройдена проверка `Наличие группы или учетной записи IIS "IIS_IUSRS"` или `Наличие модулей NTLM и Basic аутентификации`, выполните действия, перечисленные в пункте xref:PrepareServerOS.adoc[Настройка операционной системы].
* Если не пройдена проверка "Принадлежность пользователя <имя пользователя> к группе {dv} Administrators":
[loweralpha]
.. Закройте _Мастер настройки {dv}_.
.. Убедитесь, что пользователь, от имени которого выполняется настройка, добавлен в группу безопасности _{dv} Administrators_. Если требуется, добавьте пользователя в группу _{dv} Administrators_ самостоятельно.
.. +++Повторно авторизуйтесь в Windows+++ (выполните Logoff/Logon).
.. Запустите _{cns}_ и продолжите настройку.
. На странице *Веб-сервер* выберите сайт IIS для публикации сервера {dv}.
+
На выбранном сайте будет опубликовано приложение {dv}. Для приложения будет создан собственный пул: "DefaultAppPool".
. Создайте базу данных {dv}.
[loweralpha]
.. На странице *Базы данных* выберите вариант *Создать новую базу данных и подключить ее к серверу* и нажмите *Далее*.
+
image::dbListClear.png[Мастер БД {dv}]
.. На странице *Базы данных. SQL Server* укажите данные для подключения к СУБД.
+
image::connectionToDbCreate.png[Создание БД {dv}]
+
* Для БД PostgreSQL адрес сервера следует указывать без домена (например, "postgre" вместо "postgre.company.com"), или указывать IP адрес.
* Порт указывается только для PostgreSQL (по умолчанию -- 5432).
* Особенности работы через SQL и Windows-аутентификацию рассмотрены в документе _Модуль "{dv} 5. Платформа". Руководство администратора_, пункт "Особенности использования SQL и Windows-аутентификация".
* Пользователь, от имени которого будет выполняться подключение к СУБД, должен обладать следующими привилегиями:
** в Microsoft SQL Server: public, dbcreator и sysadmin;
** в PostgreSQL: пользователь "postgres" или эквивалентные права.
.. На странице *Базы данных. Создание* укажите имя создаваемой БД.
+
image::infoToDbCreate.png[Создание БД {dv}]
+
* Не используйте кириллицу, пробелы и спецсимволы в имени БД.
* Для БД Microsoft SQL Server в поле *Язык* выберите локаль БД, которая установлена в параметре _Server Collation_ (способ сортировки данных в таблицах) экземпляра Microsoft SQL Server. Рекомендуемое значение: "Cyrillic_General_CI_AS" (Русский).
* При выборе СУБД Microsoft SQL Server также можно настроить сателлитные БД -- отдельные БД для некоторых типов данных. *После создания БД изменять конфигурацию сателлитных БД не рекомендуется -- может привести к потере данных*. Для получения информации о сателлитных БД обратитесь к документу _Модуль "{dv} 5. Платформа". Руководство администратора_# пункт "Использование сателлитных баз данных".
.. На следующих трёх страницах *Базы данных. Создание* не изменяйте настройки. Нажмите *Далее* для продолжения.
+
Загрузка данных в БД {dv} может занять продолжительное время.
. На странице *Настройки Windows-клиента* оставьте настройки по умолчанию.
+
image::clientPerfomance.png[Настройки Windows-клиента]
. На странице *Завершение конфигурации* нажмите *Далее*.
. На странице *Управление Документами и Конструктор согласования* нажмите *Далее*. В БД будут загружены данные приложения "Управление документами" и модуля "Конструктор согласований".
+
Загрузка данных в БД {dv} может занять продолжительное время.
. На странице *Почтовый клиент* нажмите *Далее*. В БД будут загружены данные, необходимые для возможности работы с заданиями с помощью почтового клиента.
+
Загрузка данных в БД {dv} может занять продолжительное время.
. Настройте СУБП (сервис управления бизнес-процессами):#
+
image::ConfigMaster_9.png[Загрузка стандартной конфигурации базовых модулей {dv}]
[loweralpha]
.. xref:CreateWorkflowAccount.adoc[Создайте учетную запись для СУБП].
.. Укажите имя и пароль созданной учетной записи в блоке настроек *Настройки сервиса*.
.. Нажмите *Далее*. Будут загружены настройки модуля "Управление процессами".
+
Подключение к почтовому серверу может быть настроено позднее. Инструкция по настройке почты приведена в документе _Модуль "{dv} 5. Управление процессами". Руководство администратора_, пункт "Настройка почты".
. Нажмите на кнопку *Завершить*.

* xref:../topics/CreateWorkflowAccount.adoc[Создание учетной записи для СУБП].
